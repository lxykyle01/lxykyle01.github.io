<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Gridea</title>
<meta name="description" content="温故而知新" />
<link rel="shortcut icon" href="https://lxykyle01.github.io//favicon.ico?v=1577646526085">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link href="https://cdn.remixicon.com/releases/v1.3.1/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">

<link rel="stylesheet" href="https://lxykyle01.github.io//styles/main.css">
<link rel="alternate" type="application/atom+xml" title="Gridea - Atom Feed" href="https://lxykyle01.github.io//atom.xml">



  </head>
  <body>
    <div id="app" class="main px-4 flex flex-col lg:flex-row">
      <div id="sidebar" class="sidebar-wrapper lg:static lg:w-1/4">
  <div class="lg:sticky top-0">
    <div class="sidebar-content">
      <div class="flex lg:block p-4 lg:px-0 items-center fixed lg:static lg:block top-0 right-0 left-0 bg-white z-50">
        <i class="remixicon-menu-2-line lg:mt-4 text-2xl cursor-pointer animated fadeIn" onclick="openMenu()"></i>
        <a href="https://lxykyle01.github.io/">
          <img class="animated fadeInLeft avatar rounded-lg mx-4 lg:mt-32 lg:mx-0 mt-0 lg:w-24 lg:h-24 w-12 w-12" src="https://lxykyle01.github.io//images/avatar.png?v=1577646526085" alt="">
        </a>
        <h1 class="animated fadeInLeft lg:text-4xl font-extrabold lg:mt-8 mt-0 text-xl" style="animation-delay: 0.2s">Gridea</h1>
      </div>
      
        <div class="animated fadeInLeft" style="animation-delay: 0.4s">
          <p class="my-4 text-gray-600 font-light hidden lg:block">
            Catalog
          </p>
          <div class="toc-container hidden lg:block">
            <ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li><a href="#1-build-two-vmcentos-7">1. BUILD TWO VM(CentOS 7)</a></li>
<li><a href="#2-ssh-connection">2. SSH CONNECTION</a></li>
<li><a href="#3-remote-control">3. REMOTE CONTROL</a></li>
<li><a href="#4-hostname-and-hosts-config">4. HOSTNAME AND HOSTS CONFIG</a></li>
<li><a href="#5-close-firewall">5. Close Firewall</a></li>
<li><a href="#6-close-selinux">6. Close SElinux</a></li>
<li><a href="#7-clock-synchronise">7. Clock Synchronise</a></li>
<li><a href="#8-install-jdk18">8. Install JDK1.8</a></li>
<li><a href="#9install-other-services">9.Install Other Services</a></li>
<li><a href="#10-ssh-login-without-using-password">10. SSH login Without Using Password</a></li>
<li><a href="#11-local-repo-configration">11. Local Repo Configration</a></li>
<li><a href="#12-check-masterhdp-and-masterambariambaricentos7">12. Check master/hdp/ and master/ambari/ambari/centos7/</a></li>
<li><a href="#14-install-ambari">14. Install Ambari</a></li>
<li><a href="#15-start-ambari">15. Start Ambari</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      
    </div>
  </div>
</div>

<div class="menu-container">
  <i class="remixicon-arrow-left-line text-2xl cursor-pointer animated fadeIn close-menu-btn" onclick="closeMenu()"></i>
  <div>
    
      
        <a href="/" class="menu" style="animation-delay: 0s">
          HOME
        </a>
      
    
      
        <a href="/archives" class="menu" style="animation-delay: 0.2s">
          ARCHIVE
        </a>
      
    
      
        <a href="/tags" class="menu" style="animation-delay: 0.4s">
          TAGS
        </a>
      
    
      
        <a href="/post/about" class="menu" style="animation-delay: 0.6000000000000001s">
          ABOUT
        </a>
      
    
  </div>
  <div class="site-footer">
    <div class="py-4 text-gray-700">Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a></div>
    <a class="rss" href="https://lxykyle01.github.io//atom.xml" target="_blank">RSS</a>
  </div>
</div>
<div class="mask" onclick="closeMenu()">
</div>
      <div class="content-wrapper py-32 lg:p-8 lg:w-3/4 post-detail animated fadeIn">
        <h1 class="text-3xl font-bold lg:mt-16">How to Deploy Hadoop with Ambari</h1>
        <div class="text-sm text-gray-700 lg:my-8">
          2019-12-23 / 9 min read
        </div>
        
          <img class="post-feature-image rounded-lg mx-auto my-4" src="https://lxykyle01.github.io//post-images/ambari.jpg" alt="">
        
        <div class="post-content yue">
          <h3 id="1-build-two-vmcentos-7">1. BUILD TWO VM(CentOS 7)</h3>
<figure data-type="image" tabindex="1"><img src="https://lxykyle01.github.io//post-images/1577645718725.png" alt="" loading="lazy"></figure>
<h3 id="2-ssh-connection">2. SSH CONNECTION</h3>
<p>Create public key in Xshell,then copy it to the google cloud server.(For Users)<br>
Change root code(For Root)</p>
<h3 id="3-remote-control">3. REMOTE CONTROL</h3>
<p>Install xfce for master</p>
<pre><code class="language-c"># sodu yum groupinstall xfce 
</code></pre>
<p>Use xstart to load this command /usr/bin/xfce4-session and use Xmanager to remote connect it.<br>
Choose default setting to set up the start window.</p>
<h3 id="4-hostname-and-hosts-config">4. HOSTNAME AND HOSTS CONFIG</h3>
<p>Change hostname to the name in <em>/ect/hosts</em><br>
Add node's hostname and ip in master's hosts file and add master's hostname and ip in node's hosts file.</p>
<pre><code class="language-c">centos 7 
[root@localhost ~]# hostnamectl set-hostname master #your hostname
[root@localhost ~]# vim /etc/sysconfig/network
-------------------------------------------------------------------
# Created by anaconda
NETWORKING=yes
HOSTNAME=master #your hostname
--------------------------------------------------------------------
[root@localhost ~]# vi  /etc/hosts
--------------------------------------------------------------------
192.168.192.154 master
192.168.192.155 node
#your master and nodes ip and hostname
</code></pre>
<h3 id="5-close-firewall">5. Close Firewall</h3>
<pre><code class="language-c">centos7
[root@localhost ~]# systemctl disable firewalld.service  
[root@localhost ~]# systemctl stop firewalld.service 
</code></pre>
<h3 id="6-close-selinux">6. Close SElinux</h3>
<pre><code class="language-c">[root@localhost ~]# vi /etc/sysconfig/selinux
----------------------------------------------------------------------
SELINUX=disabled
</code></pre>
<h3 id="7-clock-synchronise">7. Clock Synchronise</h3>
<pre><code class="language-c">[root@localhost ~] yum install -y ntp  
[root@localhost ~] chkconfig --list ntpd  
[root@localhost ~] systemctl is-enabled ntpd  
[root@localhost ~] systemctl enable ntpd  
[root@localhost ~] systemctl start ntpd 
</code></pre>
<h3 id="8-install-jdk18">8. Install JDK1.8</h3>
<pre><code class="language-c">[root@localhost ~]# cd /usr/local
[root@localhost local]# mkdir jdk8
[root@localhost local]# cd jdk8
[root@master jdk8]# tar -zxvf jdk-8u231-linux-x64.tar.gz 
[root@master jdk8]# vim /etc/profile
-----------------------------------------------------------------------
#java
export JAVA_HOME=/usr/local/jdk8/jdk1.8.0_231
export JRE_HOME=$JAVA_HOME/jre
export CLASSPATH=.:$JAVA_HOME/lib:$JRE_HOME/lib
export PATH=$PATH:$JAVA_HOME/bin
------------------------------------------------------------------------
[root@master jdk8]# source /etc/profile
[root@master jdk8]# java -version #Check it
</code></pre>
<h3 id="9install-other-services">9.Install Other Services</h3>
<pre><code class="language-c">[root@localhost ~]# umask 0022
[root@ambari01 ~]# yum -y install lrzsz
[root@ambari01 ~]# yum install -y openssh-clients
</code></pre>
<p>Steps 1~9 should be done in both master and node server</p>
<h3 id="10-ssh-login-without-using-password">10. SSH login Without Using Password</h3>
<pre><code class="language-c">[root@master ~]# ssh-keygen -t rsa
[root@master ~]# cd .ssh
[root@master .ssh]# ls
id_rsa  id_rsa.pub
[root@master ~]# ssh-copy-id -i ~/.ssh/id_rsa.pub root@192.168.192.155 #node ip address
[root@master ~]# ssh-copy-id -i ~/.ssh/id_rsa.pub root@192.168.192.156 #master ip address
[root@master ~]# ssh 192.168.192.155 #test
[root@node ~]# exit
</code></pre>
<h3 id="11-local-repo-configration">11. Local Repo Configration</h3>
<p>Download these three files to master.<br>
CentOS 7：<br>
http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.5.0.3/ambari-2.5.0.3-centos7.tar.gz<br>
http://public-repo-1.hortonworks.com/HDP/centos7/2.x/updates/2.6.0.3/HDP-2.6.0.3-centos7-rpm.tar.gz<br>
http://public-repo-1.hortonworks.com/HDP-UTILS-1.1.0.21/repos/centos7/HDP-UTILS-1.1.0.21-centos7.tar.gz</p>
<pre><code class="language-c">[root@master ~]# yum install yum-utils createrepo yum-plugin-priorities -y
#Add gpgcheck=0
[root@master ~]# vi /etc/yum/pluginconf.d/priorities.conf
---------------------------------------------------------------------------
gpgcheck = 0
---------------------------------------------------------------------------
#check httpd 
[root@master ~]# yum list httpd
#install httpd
[root@master ~]# yum install httpd
#config HTTP 
[root@master ~]# chkconfig httpd on
[root@master ~]# service httpd start
#Creat local repo
[root@master ~]# cd /var/www/html/
[root@master html]# mkdir ambari
[root@master ambari]# cd ..
[root@master html]# mkdir hdp
#creat catalog and unzip

root@master Downloads]# ls
ambari-2.5.0.3-centos7.tar.gz   HDP-UTILS-1.1.0.21-centos7.tar.gz
HDP-2.6.0.3-centos7-rpm.tar.gz

[root@master Downloads]# tar -zxvf ambari-2.5.0.3-centos7.tar.gz -C /var/www/html/ambari
[root@master Downloads]# tar -zxvf HDP-2.6.0.3-centos7-rpm.tar.gz -C /var/www/html/hdp
[root@master Downloads]# tar -zxvf HDP-UTILS-1.1.0.21-centos7.tar.gz -C /var/www/html/hdp

#creat repo
[root@master Downloads]# cd /var/www/html/ambari/
[root@master ambari]# createrepo ./

[root@master Downloads]# cd /etc/yum.repos.d/
[root@master yum.repos.d]# ls
CentOS7-Base-163.repo    CentOS-Debuginfo.repo  CentOS-Sources.repo
CentOS-Base.repo.backup  CentOS-fasttrack.repo  CentOS-Vault.repo
CentOS-CR.repo           CentOS-Media.repo

[root@master yum.repos.d]# wget -nv http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.5.0.3/ambari.repo
[root@master yum.repos.d]# vim ambari.repo 
------------------------------------------------------------------------------------
#VERSION_NUMBER=2.5.0.3-7
[ambari-2.5.0.3]
name=ambari Version - ambari-2.5.0.3
baseurl=http://master/ambari/ambari/centos7/
gpgcheck=0
gpgkey=http://master/ambari/ambari/centos7/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins
enabled=1
priority=1
------------------------------------------------------------------------------------
[root@master yum.repos.d]# wget -nv http://public-repo-1.hortonworks.com/HDP/centos7/2.x/updates/2.6.0.3/hdp.repo
[root@master yum.repos.d]# vim hdp.repo 
------------------------------------------------------------------------------------
#VERSION_NUMBER=2.6.0.3-8
[HDP-2.6.0.3]
name=HDP Version - HDP-2.6.0.3
baseurl=http://master/hdp/HDP/centos7/
gpgcheck=0
gpgkey=http://master/hdp/HDP/centos7/HDP/centos7/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins
enabled=1
priority=1

[HDP-UTILS-1.1.0.21]
name=HDP-UTILS Version - HDP-UTILS-1.1.0.21
baseurl=http://master/hdp/
gpgcheck=0
gpgkey=http://master/hdp/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins
enabled=1
priority=1
-------------------------------------------------------------------------------------
# yum clean list
# yum update list
# yum makecache
# yum repolist
</code></pre>
<h3 id="12-check-masterhdp-and-masterambariambaricentos7">12. Check master/hdp/ and master/ambari/ambari/centos7/</h3>
<p><img src="https://lxykyle01.github.io//post-images/1577645825672.jpg" alt="" loading="lazy"><br>
###13. Install MySQL</p>
<pre><code class="language-c"># wget http://repo.mysql.com/mysql57-community-release-el7-8.noarch.rpm
# rpm -ivh mysql57-community-release-el7-8.noarch.rpm  --nodeps --force
# cd /etc/yum.repos.d
# ls -l
# yum install -y mysql-server
# systemctl start mysqld
# service mysqld status
# grep 'temporary password' /var/log/mysqld.log  #It will return a random password

# mysql -u root -p

mysql&gt; Enter password: # type the random passwor you got before
mysql&gt; set global validate_password_policy=0;
mysql&gt; set global validate_password_length=4;
mysql&gt; alter user 'root'@'localhost' identified by 'root-1234'; #Set your own password to replace root-1234
mysql&gt; flush privileges;
mysql&gt; quit;

# mysql -u root -p  # type the password you set before

mysql&gt; GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY ' root-1234' WITH GRANT OPTION;
mysql&gt; FLUSH PRIVILEGES;

# yum install -y mysql-connector-java

mysql&gt; create database ambari character set utf8;
mysql&gt; CREATE USER 'ambari'@'%' IDENTIFIED BY 'ambari-1234'; #Set your own password to replace ambari-1234
mysql&gt; GRANT ALL PRIVILEGES ON *.* TO 'ambari'@'%';
mysql&gt; FLUSH PRIVILEGES;

mysql&gt; create database hive character set utf8;
mysql&gt; CREATE USER 'hive'@'%' IDENTIFIED BY 'hive-1234';  #Set your own password to replace hive-1234
mysql&gt; GRANT ALL PRIVILEGES ON *.* TO 'hive'@'%';
mysql&gt; FLUSH PRIVILEGES;
</code></pre>
<h3 id="14-install-ambari">14. Install Ambari</h3>
<pre><code class="language-c"># yum install -y ambari-server
# mysql -uroot -p

mysql&gt; use ambari;
mysql&gt; source /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql;

# ambari-server setup
--------------------------------------------------------------------------------
Customize user account for ambari-server daemon [y/n] (n)? y
Enter user account for ambari-server daemon (root): root
Adjusting ambari-server permissions and ownership...
Checking JDK...Do you want to change Oracle JDK [y/n] (n)? y

[1] Oracle JDK 1.8 + Java Cryptography Extension (JCE) Policy Files 8
[2] Oracle JDK 1.7 + Java Cryptography Extension (JCE) Policy Files 7
[3] Custom JDK

==========================================

Enter choice (1): 3

JAVA_HOME=usr/local/jdk8/jdk1.8.0_231/
Configuring database...Enter advanced database configuration [y/n] (n)? y
Configuring database...
========================================

Choose one of the following options:

[1] - PostgreSQL (Embedded)
[2] - Oracle
[3] - MySQL
[4] - PostgreSQL
[5] - Microsoft SQL Server (Tech Preview)
[6] - SQL Anywhere

==========================================

Enter choice (1): 3

Hostname (localhost): ambari.server
Port (3306):
Database name (ambari):
Username (ambari):
Enter Database Password (ambari-1234):#password you set before
-------------------------------------------------------------------------------
</code></pre>
<h3 id="15-start-ambari">15. Start Ambari</h3>
<pre><code class="language-c"># ambari-server start
</code></pre>
<p>http://master:8080/#/login #USE firefox to open it</p>
<p>Username:admin<br>
Password:admin<br>
<img src="https://lxykyle01.github.io//post-images/1577645803691.jpg" alt="" loading="lazy"></p>
<p>Type cluster name: any name your want</p>
<p>Chose HDP-2.6(Defaut Version)<br>
Use local Repository<br>
<img src="https://lxykyle01.github.io//post-images/1577645785961.jpg" alt="" loading="lazy"></p>
<p>Target Hosts :Paste both master and node FQDN hostname here</p>
<p>For ssh private key: chose id_rsa from /root/.ssh(It is a hide file,you need click show hide files)</p>
<p>Next</p>
<p>Find : SSLError:Failed to connect.Please check openssl library versions.</p>
<p>Use below set for both master and node</p>
<pre><code class="language-c">vim /etc/python/cert-verification.cfg

[https]
verify=disable

vim /etc/ambari-agent/ambari-agent

[security]
force_https_protocol=PROTOCOL_TLSv1_2

# service ambari-server restart
</code></pre>
<p>And restart the webpage to retry before steps.</p>

        </div>

        


        <div class="flex justify-between py-8">
          
            <div class="prev-post">
              <a href="https://lxykyle01.github.io/post/useful-links">
                <h3 class="post-title">
                  <i class="remixicon-arrow-left-line"></i>
                  Useful Links
                </h3>
              </a>
            </div>
          

          
        </div>

        

      </div>
    </div>

    <script src="https://lxykyle01.github.io//media/prism.js"></script>  
<script>

Prism.highlightAll()

let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

// This should probably be throttled.
// Especially because it triggers during smooth scrolling.
// https://lodash.com/docs/4.17.10#throttle
// You could do like...
// window.addEventListener("scroll", () => {
//    _.throttle(doThatStuff, 100);
// });
// Only not doing it here to keep this Pen dependency-free.

window.addEventListener("scroll", event => {
  let fromTop = window.scrollY;

  mainNavLinks.forEach((link, index) => {
    let section = document.getElementById(decodeURI(link.hash).substring(1));
    let nextSection = null
    if (mainNavLinks[index + 1]) {
      nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
    }
    if (section.offsetTop <= fromTop) {
      if (nextSection) {
        if (nextSection.offsetTop > fromTop) {
          link.classList.add("current");
        } else {
          link.classList.remove("current");    
        }
      } else {
        link.classList.add("current");
      }
    } else {
      link.classList.remove("current");
    }
  });
});


document.addEventListener("DOMContentLoaded", function() {
  var lazyImages = [].slice.call(document.querySelectorAll(".post-feature-image.lazy"));

  if ("IntersectionObserver" in window) {
    let lazyImageObserver = new IntersectionObserver(function(entries, observer) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          let lazyImage = entry.target
          lazyImage.style.backgroundImage = `url(${lazyImage.dataset.bg})`
          lazyImage.classList.remove("lazy")
          lazyImageObserver.unobserve(lazyImage)
        }
      });
    });

    lazyImages.forEach(function(lazyImage) {
      lazyImageObserver.observe(lazyImage)
    })
  } else {
    // Possibly fall back to a more compatible method here
  }
});

const menuContainer = document.querySelector('.menu-container')
const menus = document.querySelectorAll('.menu-container .menu')
const mask = document.querySelector('.mask')
const contentWrapper = document.querySelector('.content-wrapper')
const latestArticle = document.querySelector('.latest-article')
const readMore = document.querySelector('.read-more')
const indexPage = document.querySelector('.index-page')

const isHome = location.pathname === '/'
if (latestArticle) {
  latestArticle.style.display = isHome ? 'block' : 'none'
  readMore.style.display = isHome ? 'block' : 'none'
  indexPage.style.display = isHome ? 'none' : 'block'
}

const openMenu = () => {
  menuContainer.classList.add('open')
  menus.forEach(menu => {
    menu.classList.add('animated', 'fadeInLeft')
  })
  mask.classList.add('open')
  contentWrapper.classList.add('is-second')
}

const closeMenu = () => {
  menuContainer.classList.remove('open')
  menus.forEach(menu => {
    menu.classList.remove('animated', 'fadeInLeft')
  })
  mask.classList.remove('open')
  contentWrapper.classList.remove('is-second')
}
</script>
  
  </body>
</html>
